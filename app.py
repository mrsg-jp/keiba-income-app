（中略：コード内容は前ステップのまま）